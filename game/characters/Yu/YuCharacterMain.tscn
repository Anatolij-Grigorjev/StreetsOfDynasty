[gd_scene load_steps=38 format=2]

[ext_resource path="res://characters/Yu/YuStateMachine.gd" type="Script" id=1]
[ext_resource path="res://characters/CharacterTemplate.tscn" type="PackedScene" id=2]
[ext_resource path="res://characters/Yu/YuCharacterRig.tscn" type="PackedScene" id=3]
[ext_resource path="res://characters/states/PerpetualState.gd" type="Script" id=4]
[ext_resource path="res://characters/states/state_aspects/WalkStateAspect.gd" type="Script" id=5]
[ext_resource path="res://characters/states/FiniteState.gd" type="Script" id=6]
[ext_resource path="res://characters/states/state_aspects/HurtStateAspect.gd" type="Script" id=7]
[ext_resource path="res://characters/AreaGroupTimeline.gd" type="Script" id=8]
[ext_resource path="res://characters/Hitbox.gd" type="Script" id=9]
[ext_resource path="res://characters/AttackBox.gd" type="Script" id=10]
[ext_resource path="res://characters/Yu/YuCharacterMain.gd" type="Script" id=11]
[ext_resource path="res://Logger.gd" type="Script" id=12]
[ext_resource path="res://characters/states/StateMachineState.gd" type="Script" id=13]
[ext_resource path="res://characters/states/state_aspects/AttackStatePhaseAspect.gd" type="Script" id=14]
[ext_resource path="res://characters/states/state_aspects/MoveToEnemyStateAspect.gd" type="Script" id=15]
[ext_resource path="res://characters/states/state_aspects/MovedStateAspect.gd" type="Script" id=16]
[ext_resource path="res://characters/Yu/YuCatchingStateMachine.gd" type="Script" id=17]
[ext_resource path="res://characters/InvincibilityBlinker.tscn" type="PackedScene" id=18]
[ext_resource path="res://characters/live_data/CharacterStabilityLabel.gd" type="Script" id=19]
[ext_resource path="res://characters/live_data/CharacterPositionLabel.gd" type="Script" id=20]
[ext_resource path="res://characters/live_data/CharacterDataDisplayLabels.gd" type="Script" id=21]
[ext_resource path="res://characters/live_data/CharacterStateLabel.gd" type="Script" id=22]

[sub_resource type="RectangleShape2D" id=1]
extents = Vector2( 38.2845, 178.026 )

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 52.6578, 185.16 )

[sub_resource type="RectangleShape2D" id=3]
extents = Vector2( 69.0345, 194.518 )

[sub_resource type="RectangleShape2D" id=4]
extents = Vector2( 49.9709, 151.65 )

[sub_resource type="RectangleShape2D" id=5]
extents = Vector2( 52.938, 149.277 )

[sub_resource type="RectangleShape2D" id=6]
extents = Vector2( 42.1761, 150.383 )

[sub_resource type="RectangleShape2D" id=7]
extents = Vector2( 55.0357, 149.606 )

[sub_resource type="RectangleShape2D" id=8]
extents = Vector2( 82.7745, 127.069 )

[sub_resource type="RectangleShape2D" id=9]
extents = Vector2( 85.375, 97.5963 )

[sub_resource type="RectangleShape2D" id=10]
extents = Vector2( 201.246, 46.767 )

[sub_resource type="RectangleShape2D" id=11]
extents = Vector2( 138.288, 44.0404 )

[sub_resource type="RectangleShape2D" id=12]
extents = Vector2( 40.1046, 129.494 )

[sub_resource type="RectangleShape2D" id=13]
extents = Vector2( 138.288, 44 )

[sub_resource type="RectangleShape2D" id=14]
extents = Vector2( 70, 36.272 )

[sub_resource type="StyleBoxFlat" id=15]
bg_color = Color( 0, 0, 0, 1 )

[node name="YuCharacterMain" groups=[
"Player",
] instance=ExtResource( 2 )]
script = ExtResource( 11 )
sprite_size = Vector2( 300, 400 )

[node name="FSM" parent="." index="0"]
script = ExtResource( 1 )

[node name="Idle" type="Node" parent="FSM" index="0"]
script = ExtResource( 4 )
state_params_filepath = "res://characters/Yu/state_data/idle.json"
hitbox_areas_timeline_path = NodePath("../../Body/HitboxGroup/HitboxTimeline")

[node name="Walk" type="Node" parent="FSM" index="1"]
script = ExtResource( 4 )
state_params_filepath = "res://characters/Yu/state_data/walk.json"
hitbox_areas_timeline_path = NodePath("../../Body/HitboxGroup/HitboxTimeline")

[node name="WalkStateAspect" type="Node" parent="FSM/Walk" index="0"]
script = ExtResource( 5 )

[node name="AttackA1" type="Node" parent="FSM" index="2"]
script = ExtResource( 6 )
state_params_filepath = "res://characters/Yu/state_data/attack_a1.json"
hitbox_areas_timeline_path = NodePath("../../Body/HitboxGroup/HitboxTimeline")
attackbox_areas_timeline_path = NodePath("../../Body/AttackboxGroup/AttackboxTimeline")
tween_path = NodePath("../../Body/Tween")
next_state = "Idle"

[node name="WalkStateAspect" type="Node" parent="FSM/AttackA1" index="0"]
script = ExtResource( 5 )
move_speed = Vector2( 5, 9 )
change_facing = false

[node name="AttackStatePhaseAspect" type="Node" parent="FSM/AttackA1" index="1"]
script = ExtResource( 14 )

[node name="MoveToEnemyStateAspect" type="Node" parent="FSM/AttackA1" index="2"]
script = ExtResource( 15 )
collision_mask = 96

[node name="AttackA2" type="Node" parent="FSM" index="3"]
script = ExtResource( 6 )
state_params_filepath = "res://characters/Yu/state_data/attack_a2.json"
hitbox_areas_timeline_path = NodePath("../../Body/HitboxGroup/HitboxTimeline")
attackbox_areas_timeline_path = NodePath("../../Body/AttackboxGroup/AttackboxTimeline")
tween_path = NodePath("../../Body/Tween")
next_state = "Idle"
state_commit_end_sec = 0.73
state_length_sec = 0.8

[node name="WalkStateAspect" type="Node" parent="FSM/AttackA2" index="0"]
script = ExtResource( 5 )
move_speed = Vector2( 7, 2 )
change_facing = false

[node name="MoveToEnemyStateAspect" type="Node" parent="FSM/AttackA2" index="1"]
script = ExtResource( 15 )
collision_mask = 96

[node name="HurtLow" type="Node" parent="FSM" index="4"]
script = ExtResource( 6 )
state_params_filepath = "res://characters/Yu/state_data/hurt_low.json"
hitbox_areas_timeline_path = NodePath("../../Body/HitboxGroup/HitboxTimeline")
next_state = "Idle"
state_commit_end_sec = 1.0
state_length_sec = 1.2

[node name="HurtEndStateAspect" type="Node" parent="FSM/HurtLow" index="0"]
script = ExtResource( 7 )

[node name="MovedStateAspect" type="Node" parent="FSM/HurtLow" index="1"]
script = ExtResource( 16 )
move_easing = 2

[node name="Catching" type="Node" parent="FSM" index="5"]
script = ExtResource( 13 )
initial_state = "CatchIdle"

[node name="FSM" type="Node" parent="FSM/Catching" index="0"]
script = ExtResource( 17 )
entity_path = NodePath("../../..")

[node name="CatchIdle" type="Node" parent="FSM/Catching/FSM" index="0"]
script = ExtResource( 6 )
state_params_filepath = "res://characters/Yu/state_data/catch_idle.json"
hitbox_areas_timeline_path = NodePath("../../../../Body/HitboxGroup/HitboxTimeline")
next_state = "CatchIdle"
state_commit_end_sec = 5.0
state_length_sec = 5.0

[node name="CatchAttack" type="Node" parent="FSM/Catching/FSM" index="1"]
script = ExtResource( 6 )
state_params_filepath = "res://characters/Yu/state_data/catch_attack.json"
hitbox_areas_timeline_path = NodePath("../../../../Body/HitboxGroup/HitboxTimeline")
attackbox_areas_timeline_path = NodePath("../../../../Body/AttackboxGroup/AttackboxTimeline")
next_state = "CatchIdle"
state_commit_end_sec = 0.8
state_length_sec = 0.8

[node name="YuCharacterRig" parent="Body" index="0" instance=ExtResource( 3 )]
position = Vector2( 0, -150 )

[node name="HitboxGroup" parent="Body" index="1"]
entity_path = NodePath("../../../YuCharacterMain/Body")

[node name="Idle" type="Area2D" parent="Body/HitboxGroup" index="0"]
collision_layer = 512
collision_mask = 0
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/Idle" index="0"]
position = Vector2( 3.1915, -160.209 )
shape = SubResource( 1 )
__meta__ = {
"_editor_description_": ""
}

[node name="Walk" type="Area2D" parent="Body/HitboxGroup" index="1"]
visible = false
collision_layer = 512
collision_mask = 96
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/Walk" index="0"]
position = Vector2( -18.3044, -143.205 )
shape = SubResource( 2 )
__meta__ = {
"_editor_description_": ""
}

[node name="AttackA1" type="Area2D" parent="Body/HitboxGroup" index="2"]
visible = false
collision_layer = 512
collision_mask = 0
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/AttackA1" index="0"]
position = Vector2( -10.6253, -145.493 )
shape = SubResource( 3 )
__meta__ = {
"_editor_description_": ""
}

[node name="AttackA2_1" type="Area2D" parent="Body/HitboxGroup" index="3"]
visible = false
collision_layer = 512
collision_mask = 0
script = ExtResource( 9 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/AttackA2_1" index="0"]
position = Vector2( -2.37372, -156.071 )
shape = SubResource( 4 )

[node name="AttackA2_2" type="Area2D" parent="Body/HitboxGroup" index="4"]
visible = false
collision_layer = 512
collision_mask = 0
script = ExtResource( 9 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/AttackA2_2" index="0"]
position = Vector2( -35.6056, -153.104 )
shape = SubResource( 5 )

[node name="HurtLow1" type="Area2D" parent="Body/HitboxGroup" index="5"]
visible = false
collision_layer = 1024
collision_mask = 0
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/HurtLow1" index="0"]
position = Vector2( -13.8321, -176.36 )
shape = SubResource( 6 )
__meta__ = {
"_editor_description_": ""
}

[node name="HurtLow2" type="Area2D" parent="Body/HitboxGroup" index="6"]
visible = false
collision_layer = 1024
collision_mask = 0
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/HurtLow2" index="0"]
position = Vector2( -37.2366, -142.12 )
shape = SubResource( 7 )
__meta__ = {
"_editor_description_": ""
}

[node name="HurtLow3" type="Area2D" parent="Body/HitboxGroup" index="7"]
visible = false
collision_layer = 1024
collision_mask = 0
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/HurtLow3" index="0"]
position = Vector2( -62.8082, -119.149 )
shape = SubResource( 8 )
__meta__ = {
"_editor_description_": ""
}

[node name="HurtLow4" type="Area2D" parent="Body/HitboxGroup" index="8"]
visible = false
collision_layer = 1024
collision_mask = 0
script = ExtResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/HitboxGroup/HurtLow4" index="0"]
position = Vector2( -86.2128, -119.582 )
shape = SubResource( 9 )
__meta__ = {
"_editor_description_": ""
}

[node name="HitboxTimeline" type="Node2D" parent="Body/HitboxGroup" index="9"]
script = ExtResource( 8 )

[node name="AttackboxGroup" parent="Body" index="2"]
entity_path = NodePath("../../../YuCharacterMain/Body")

[node name="AttackA1" type="Area2D" parent="Body/AttackboxGroup" index="0"]
collision_layer = 0
collision_mask = 32
script = ExtResource( 10 )
__meta__ = {
"_editor_description_": ""
}
damage_type = 1
damage_amount = 16.0
disruption = 40.0
target_move = Vector2( -35, 0 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/AttackboxGroup/AttackA1" index="0"]
position = Vector2( 232.488, -177.854 )
shape = SubResource( 10 )
__meta__ = {
"_editor_description_": ""
}

[node name="AttackA2" type="Area2D" parent="Body/AttackboxGroup" index="1"]
collision_layer = 0
collision_mask = 96
script = ExtResource( 10 )
damage_amount = 20.0
disruption = 80.0
target_move = Vector2( 150, 0 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/AttackboxGroup/AttackA2" index="0"]
position = Vector2( 147.093, -196.714 )
shape = SubResource( 11 )

[node name="CatchAttack1" type="Area2D" parent="Body/AttackboxGroup" index="2"]
collision_layer = 0
collision_mask = 128
script = ExtResource( 10 )
damage_amount = 10.0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/AttackboxGroup/CatchAttack1" index="0"]
position = Vector2( 105.77, -141.765 )
shape = SubResource( 12 )

[node name="CatchAttack2" type="Area2D" parent="Body/AttackboxGroup" index="3"]
collision_layer = 0
collision_mask = 128
script = ExtResource( 10 )
damage_amount = 15.0
target_move = Vector2( 175, -5 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Body/AttackboxGroup/CatchAttack2" index="0"]
position = Vector2( 147.093, -196.714 )
shape = SubResource( 13 )

[node name="AttackboxTimeline" type="Node2D" parent="Body/AttackboxGroup" index="4"]
script = ExtResource( 8 )

[node name="Tween" type="Tween" parent="Body" index="3"]

[node name="CatchPoint" parent="Body" index="4"]
position = Vector2( 75.9019, -196.513 )

[node name="Terrain" type="CollisionShape2D" parent="." index="2"]
position = Vector2( 0, 25 )
shape = SubResource( 14 )
__meta__ = {
"_editor_description_": ""
}

[node name="Logger" type="Node" parent="." index="3"]
script = ExtResource( 12 )

[node name="InvincibilityBlinker" parent="." index="4" instance=ExtResource( 18 )]
pre_blink_states = [ "Falling", "HurtLow" ]

[node name="CharacterDataDisplayLabels" type="Node2D" parent="." index="5"]
script = ExtResource( 21 )

[node name="CharacterPositionLabel" type="Label" parent="CharacterDataDisplayLabels" index="0"]
margin_left = -149.552
margin_top = -427.967
margin_right = -49.5517
margin_bottom = -402.967
rect_min_size = Vector2( 100, 25 )
rect_scale = Vector2( 1.5, 1.5 )
custom_styles/normal = SubResource( 15 )
text = "<NO_STATE>"
align = 1
valign = 1
script = ExtResource( 20 )
__meta__ = {
"_edit_use_anchors_": false,
"_editor_description_": ""
}

[node name="CharacterStabilityLabel" type="Label" parent="CharacterDataDisplayLabels" index="1"]
margin_left = -1.18565
margin_top = -429.429
margin_right = 98.8143
margin_bottom = -404.429
rect_min_size = Vector2( 100, 25 )
rect_scale = Vector2( 1.5, 1.5 )
custom_styles/normal = SubResource( 15 )
text = "<NO_STATE>"
align = 1
valign = 1
script = ExtResource( 19 )
__meta__ = {
"_edit_use_anchors_": false,
"_editor_description_": ""
}

[node name="CharacterStateLabel" type="Label" parent="CharacterDataDisplayLabels" index="2"]
margin_left = -72.0798
margin_top = -390.693
margin_right = 27.9202
margin_bottom = -365.693
rect_min_size = Vector2( 100, 25 )
rect_scale = Vector2( 1.5, 1.5 )
custom_styles/normal = SubResource( 15 )
text = "<NO_STATE>"
align = 1
valign = 1
script = ExtResource( 22 )
__meta__ = {
"_edit_use_anchors_": false,
"_editor_description_": ""
}
[connection signal="state_changed" from="FSM" to="InvincibilityBlinker" method="_on_CharacterTemplate_state_changed"]
